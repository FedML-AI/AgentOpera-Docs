

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>engine.agent &mdash; AgentOpera API References 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=888ff710"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="engine.function_call" href="engine.function_call.html" />
    <link rel="prev" title="engine" href="engine.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AgentOpera API References
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Chatflow Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.html">chatflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.agents.html">chatflow.agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.base.html">chatflow.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.conditions.html">chatflow.conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.media.html">chatflow.media</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.state.html">chatflow.state</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.team.html">chatflow.team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.ui.html">chatflow.ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chatflow/chatflow.utils.html">chatflow.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Engine Module</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="engine.html">engine</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">engine.agent</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.Agent"><code class="docutils literal notranslate"><span class="pre">Agent</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.Agent.metadata"><code class="docutils literal notranslate"><span class="pre">Agent.metadata</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.Agent.id"><code class="docutils literal notranslate"><span class="pre">Agent.id</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.Agent.on_message"><code class="docutils literal notranslate"><span class="pre">Agent.on_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.Agent.save_state"><code class="docutils literal notranslate"><span class="pre">Agent.save_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.Agent.load_state"><code class="docutils literal notranslate"><span class="pre">Agent.load_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.Agent.close"><code class="docutils literal notranslate"><span class="pre">Agent.close()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent"><code class="docutils literal notranslate"><span class="pre">BaseAgent</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.metadata"><code class="docutils literal notranslate"><span class="pre">BaseAgent.metadata</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.type"><code class="docutils literal notranslate"><span class="pre">BaseAgent.type</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.id"><code class="docutils literal notranslate"><span class="pre">BaseAgent.id</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.engine"><code class="docutils literal notranslate"><span class="pre">BaseAgent.engine</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.on_message"><code class="docutils literal notranslate"><span class="pre">BaseAgent.on_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.on_message_impl"><code class="docutils literal notranslate"><span class="pre">BaseAgent.on_message_impl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.send_message"><code class="docutils literal notranslate"><span class="pre">BaseAgent.send_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.publish_message"><code class="docutils literal notranslate"><span class="pre">BaseAgent.publish_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.save_state"><code class="docutils literal notranslate"><span class="pre">BaseAgent.save_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.load_state"><code class="docutils literal notranslate"><span class="pre">BaseAgent.load_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.close"><code class="docutils literal notranslate"><span class="pre">BaseAgent.close()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.BaseAgent.register"><code class="docutils literal notranslate"><span class="pre">BaseAgent.register()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent"><code class="docutils literal notranslate"><span class="pre">ClosureAgent</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.metadata"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.metadata</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.id"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.id</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.engine"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.engine</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.on_message_impl"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.on_message_impl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.save_state"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.save_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.load_state"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.load_state()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureAgent.register_closure"><code class="docutils literal notranslate"><span class="pre">ClosureAgent.register_closure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.ClosureContext"><code class="docutils literal notranslate"><span class="pre">ClosureContext</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureContext.id"><code class="docutils literal notranslate"><span class="pre">ClosureContext.id</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureContext.send_message"><code class="docutils literal notranslate"><span class="pre">ClosureContext.send_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ClosureContext.publish_message"><code class="docutils literal notranslate"><span class="pre">ClosureContext.publish_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.RoutedAgent"><code class="docutils literal notranslate"><span class="pre">RoutedAgent</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.RoutedAgent.cancel_token"><code class="docutils literal notranslate"><span class="pre">RoutedAgent.cancel_token</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.RoutedAgent.trigger_transient_cancel"><code class="docutils literal notranslate"><span class="pre">RoutedAgent.trigger_transient_cancel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.RoutedAgent.on_message_impl"><code class="docutils literal notranslate"><span class="pre">RoutedAgent.on_message_impl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.RoutedAgent.on_unhandled_message"><code class="docutils literal notranslate"><span class="pre">RoutedAgent.on_unhandled_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.event"><code class="docutils literal notranslate"><span class="pre">event()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.message_handler"><code class="docutils literal notranslate"><span class="pre">message_handler()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.rpc"><code class="docutils literal notranslate"><span class="pre">rpc()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#agentopera.engine.agent.ToolAgent"><code class="docutils literal notranslate"><span class="pre">ToolAgent</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ToolAgent.tools"><code class="docutils literal notranslate"><span class="pre">ToolAgent.tools</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#agentopera.engine.agent.ToolAgent.handle_function_call"><code class="docutils literal notranslate"><span class="pre">ToolAgent.handle_function_call()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="engine.function_call.html">engine.function_call</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine.protocol.html">engine.protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine.runtime.html">engine.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine.telemetry.html">engine.telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="engine.types.html">engine.types</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Agents Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.html">agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.openai.html">agents.openai</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.magentic_one.html">agents.magentic_one</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.magentic_one_team.html">agents.magentic_one_team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.web_surfer.html">agents.web_surfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.video_surfer.html">agents.video_surfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.file_surfer.html">agents.file_surfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agents/agents.code_executor.html">agents.code_executor</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Router Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../router/router.html">router</a></li>
<li class="toctree-l1"><a class="reference internal" href="../router/router.workers.html">router.workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../router/router.user.html">router.user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../router/router.session.html">router.session</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/models.html">models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.openai.html">models.openai</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.anthropic.html">models.anthropic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.azure.html">models.azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.ollama.html">models.ollama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.replay.html">models.replay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.cache.html">models.cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models/models.utils.html">models.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Memory Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../memory/memory.html">memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../memory/memory.graphrag.html">memory.graphrag</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tools/tools.html">tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/tools.http.html">tools.http</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/tools.code_execution.html">tools.code_execution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">UI Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ui/ui.html">ui</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utils Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/utils.html">utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Adapter Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../adapter/adapter.html">adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../adapter/adapter.langchain.html">adapter.langchain</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MCP Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mcp/mcp.html">mcp</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Zerocode Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../zerocode/zerocode.html">zerocode</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Edge Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../edge/edge.html">edge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AgentOpera API References</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="engine.html">engine</a></li>
      <li class="breadcrumb-item active">engine.agent</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/engine/engine.agent.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-agentopera.engine.agent">
<span id="engine-agent"></span><h1>engine.agent<a class="headerlink" href="#module-agentopera.engine.agent" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/agentopera/engine/types/agent/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.Agent" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentMetadata" title="agentopera.engine.types.agent.agent_metadata.AgentMetadata"><span class="pre">AgentMetadata</span></a></em><a class="headerlink" href="#agentopera.engine.agent.Agent.metadata" title="Link to this definition"></a></dt>
<dd><p>Metadata of the agent.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentId" title="agentopera.engine.types.agent.agent_id.AgentId"><span class="pre">AgentId</span></a></em><a class="headerlink" href="#agentopera.engine.agent.Agent.id" title="Link to this definition"></a></dt>
<dd><p>ID of the agent.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent.on_message">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/types/agent/agent.html#Agent.on_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.Agent.on_message" title="Link to this definition"></a></dt>
<dd><p>Message handler for the agent. This should only be called by the engine, not by other agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>Any</em>) – Received message. Type is one of the types in <cite>subscriptions</cite>.</p></li>
<li><p><strong>ctx</strong> (<a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.MessageContext"><em>MessageContext</em></a>) – Context of the message.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response to the message. Can be None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>asyncio.CancelledError</strong> – If the message was cancelled.</p></li>
<li><p><strong>CantHandleException</strong> – If the agent cannot handle the message.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent.save_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/agentopera/engine/types/agent/agent.html#Agent.save_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.Agent.save_state" title="Link to this definition"></a></dt>
<dd><p>Save the state of the agent. The result must be JSON serializable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent.load_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/types/agent/agent.html#Agent.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.Agent.load_state" title="Link to this definition"></a></dt>
<dd><p>Load in the state of the agent obtained from <cite>save_state</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – State of the agent. Must be JSON serializable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.Agent.close">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/types/agent/agent.html#Agent.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.Agent.close" title="Link to this definition"></a></dt>
<dd><p>Called when the engine is closed</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">BaseAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code>, <a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.Agent" title="agentopera.engine.types.agent.agent.Agent"><code class="xref py py-class docutils literal notranslate"><span class="pre">Agent</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentMetadata" title="agentopera.engine.types.agent.agent_metadata.AgentMetadata"><span class="pre">AgentMetadata</span></a></em><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.metadata" title="Link to this definition"></a></dt>
<dd><p>Metadata of the agent.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentId" title="agentopera.engine.types.agent.agent_id.AgentId"><span class="pre">AgentId</span></a></em><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.id" title="Link to this definition"></a></dt>
<dd><p>ID of the agent.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.engine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.runtime.html#agentopera.engine.runtime.AgentEngine" title="agentopera.engine.runtime.agent_engine.AgentEngine"><span class="pre">AgentEngine</span></a></em><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.engine" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.on_message">
<em class="property"><span class="pre">final</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.on_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.on_message" title="Link to this definition"></a></dt>
<dd><p>Message handler for the agent. This should only be called by the engine, not by other agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<em>Any</em>) – Received message. Type is one of the types in <cite>subscriptions</cite>.</p></li>
<li><p><strong>ctx</strong> (<a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.MessageContext"><em>MessageContext</em></a>) – Context of the message.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Response to the message. Can be None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>asyncio.CancelledError</strong> – If the message was cancelled.</p></li>
<li><p><strong>CantHandleException</strong> – If the agent cannot handle the message.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.on_message_impl">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_message_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.on_message_impl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.on_message_impl" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.send_message">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentId" title="agentopera.engine.types.agent.agent_id.AgentId"><span class="pre">AgentId</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancellation_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.CancellationToken" title="agentopera.engine.types.agent.cancellation_token.CancellationToken"><span class="pre">CancellationToken</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.send_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.send_message" title="Link to this definition"></a></dt>
<dd><p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">agentopera.core.AgentEngine.send_message()</span></code> for more information.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.publish_message">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">publish_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_channel.MessageChannel" title="agentopera.engine.types.msg_channel.message_channel.MessageChannel"><span class="pre">MessageChannel</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancellation_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.CancellationToken" title="agentopera.engine.types.agent.cancellation_token.CancellationToken"><span class="pre">CancellationToken</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.publish_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.publish_message" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.save_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.save_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.save_state" title="Link to this definition"></a></dt>
<dd><p>Save the state of the agent. The result must be JSON serializable.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.load_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.load_state" title="Link to this definition"></a></dt>
<dd><p>Load in the state of the agent obtained from <cite>save_state</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Mapping</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – State of the agent. Must be JSON serializable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.close">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.close" title="Link to this definition"></a></dt>
<dd><p>Called when the engine is closed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.BaseAgent.register">
<em class="property"><span class="pre">async</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.runtime.html#agentopera.engine.runtime.AgentEngine" title="agentopera.engine.runtime.agent_engine.AgentEngine"><span class="pre">AgentEngine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agent_builder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Self</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">Self</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_class_subscriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_direct_message_subscription</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentType" title="agentopera.engine.types.agent.agent_type.AgentType"><span class="pre">AgentType</span></a></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/base_agent.html#BaseAgent.register"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.BaseAgent.register" title="Link to this definition"></a></dt>
<dd><p>Register a virtual subclass of an ABC.</p>
<p>Returns the subclass, to allow usage as a class decorator.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">ClosureAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#agentopera.engine.agent.ClosureContext" title="agentopera.engine.agent.closure_agent.ClosureContext"><span class="pre">ClosureContext</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_type_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warn'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'ignore'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'warn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#agentopera.engine.agent.BaseAgent" title="agentopera.engine.agent.base_agent.BaseAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAgent</span></code></a>, <a class="reference internal" href="#agentopera.engine.agent.ClosureContext" title="agentopera.engine.agent.closure_agent.ClosureContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClosureContext</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentMetadata" title="agentopera.engine.types.agent.agent_metadata.AgentMetadata"><span class="pre">AgentMetadata</span></a></em><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.metadata" title="Link to this definition"></a></dt>
<dd><p>Metadata of the agent.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentId" title="agentopera.engine.types.agent.agent_id.AgentId"><span class="pre">AgentId</span></a></em><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.id" title="Link to this definition"></a></dt>
<dd><p>ID of the agent.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.engine">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">engine</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.runtime.html#agentopera.engine.runtime.AgentEngine" title="agentopera.engine.runtime.agent_engine.AgentEngine"><span class="pre">AgentEngine</span></a></em><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.engine" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.on_message_impl">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_message_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureAgent.on_message_impl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.on_message_impl" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.save_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureAgent.save_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.save_state" title="Link to this definition"></a></dt>
<dd><p>Closure agents do not have state. So this method always returns an empty dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.load_state">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Mapping</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureAgent.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.load_state" title="Link to this definition"></a></dt>
<dd><p>Closure agents do not have state. So this method does nothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureAgent.register_closure">
<em class="property"><span class="pre">async</span><span class="w"> </span><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">register_closure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.runtime.html#agentopera.engine.runtime.AgentEngine" title="agentopera.engine.runtime.agent_engine.AgentEngine"><span class="pre">AgentEngine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#agentopera.engine.agent.ClosureContext" title="agentopera.engine.agent.closure_agent.ClosureContext"><span class="pre">ClosureContext</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">T</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unknown_type_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'error'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warn'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'ignore'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'warn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_direct_message_subscription</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subscriptions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="engine.html#agentopera.engine.Subscription" title="agentopera.engine.subscription.subscription.Subscription"><span class="pre">Subscription</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Awaitable</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="engine.html#agentopera.engine.Subscription" title="agentopera.engine.subscription.subscription.Subscription"><span class="pre">Subscription</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentType" title="agentopera.engine.types.agent.agent_type.AgentType"><span class="pre">AgentType</span></a></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureAgent.register_closure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureAgent.register_closure" title="Link to this definition"></a></dt>
<dd><p>The closure agent allows you to define an agent using a closure, or function without needing to define a class. It allows values to be extracted out of the engine.</p>
<p>The closure can define the type of message which is expected, or <cite>Any</cite> can be used to accept any type of message.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">LocalAgentEngine</span><span class="p">,</span> <span class="n">MessageContext</span><span class="p">,</span> <span class="n">ClosureAgent</span><span class="p">,</span> <span class="n">ClosureContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.engine.protocol.subscription.default_subscription</span><span class="w"> </span><span class="kn">import</span> <span class="n">DefaultSubscription</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.engine.protocol.subscription.default_topic</span><span class="w"> </span><span class="kn">import</span> <span class="n">DefaultTopicId</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyMessage</span><span class="p">:</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span>


<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">Queue</span><span class="p">[</span><span class="n">MyMessage</span><span class="p">]()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">output_result</span><span class="p">(</span><span class="n">_ctx</span><span class="p">:</span> <span class="n">ClosureContext</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">MyMessage</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">await</span> <span class="n">queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="n">engine</span> <span class="o">=</span> <span class="n">LocalAgentEngine</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">ClosureAgent</span><span class="o">.</span><span class="n">register_closure</span><span class="p">(</span>
        <span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;output_result&quot;</span><span class="p">,</span> <span class="n">output_result</span><span class="p">,</span> <span class="n">subscriptions</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">[</span><span class="n">DefaultSubscription</span><span class="p">()]</span>
    <span class="p">)</span>

    <span class="n">engine</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">publish_message</span><span class="p">(</span><span class="n">MyMessage</span><span class="p">(</span><span class="s2">&quot;Hello, world!&quot;</span><span class="p">),</span> <span class="n">DefaultTopicId</span><span class="p">())</span>
    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">stop_when_idle</span><span class="p">()</span>

    <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="n">queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>


<span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>engine</strong> (<a class="reference internal" href="engine.runtime.html#agentopera.engine.runtime.AgentEngine" title="agentopera.engine.runtime.AgentEngine"><em>AgentEngine</em></a>) – Engine to register the agent to</p></li>
<li><p><strong>type</strong> (<em>str</em>) – Agent type of registered agent</p></li>
<li><p><strong>closure</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="#agentopera.engine.agent.ClosureContext" title="agentopera.engine.agent.ClosureContext"><em>ClosureContext</em></a><em>, </em><em>T</em><em>, </em><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.MessageContext"><em>MessageContext</em></a><em>]</em><em>, </em><em>Awaitable</em><em>[</em><em>Any</em><em>]</em><em>]</em>) – Closure to handle messages</p></li>
<li><p><strong>unknown_type_policy</strong> (<em>Literal</em><em>[</em><em>&quot;error&quot;</em><em>, </em><em>&quot;warn&quot;</em><em>, </em><em>&quot;ignore&quot;</em><em>]</em><em>, </em><em>optional</em>) – What to do if a type is encountered that does not match the closure type. Defaults to “warn”.</p></li>
<li><p><strong>skip_direct_message_subscription</strong> (<em>bool</em><em>, </em><em>optional</em>) – Do not add direct message subscription for this agent. Defaults to False.</p></li>
<li><p><strong>description</strong> (<em>str</em><em>, </em><em>optional</em>) – Description of what agent does. Defaults to “”.</p></li>
<li><p><strong>subscriptions</strong> (<em>Callable</em><em>[</em><em>[</em><em>]</em><em>, </em><em>list</em><em>[</em><a class="reference internal" href="engine.html#agentopera.engine.Subscription" title="agentopera.engine.Subscription"><em>Subscription</em></a><em>]  </em><em>|  </em><em>Awaitable</em><em>[</em><em>list</em><em>[</em><a class="reference internal" href="engine.html#agentopera.engine.Subscription" title="agentopera.engine.Subscription"><em>Subscription</em></a><em>]</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – List of subscriptions for this closure agent. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Type of the agent that was registered</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentType" title="agentopera.engine.types.agent.AgentType">AgentType</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureContext">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">ClosureContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureContext"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureContext" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureContext.id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentId" title="agentopera.engine.types.agent.agent_id.AgentId"><span class="pre">AgentId</span></a></em><a class="headerlink" href="#agentopera.engine.agent.ClosureContext.id" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureContext.send_message">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recipient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.AgentId" title="agentopera.engine.types.agent.agent_id.AgentId"><span class="pre">AgentId</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancellation_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.CancellationToken" title="agentopera.engine.types.agent.cancellation_token.CancellationToken"><span class="pre">CancellationToken</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureContext.send_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureContext.send_message" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ClosureContext.publish_message">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">publish_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message_channel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_channel.MessageChannel" title="agentopera.engine.types.msg_channel.message_channel.MessageChannel"><span class="pre">MessageChannel</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cancellation_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.CancellationToken" title="agentopera.engine.types.agent.cancellation_token.CancellationToken"><span class="pre">CancellationToken</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/closure_agent.html#ClosureContext.publish_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ClosureContext.publish_message" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="agentopera.engine.agent.RoutedAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">RoutedAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#RoutedAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.RoutedAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#agentopera.engine.agent.BaseAgent" title="agentopera.engine.agent.base_agent.BaseAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseAgent</span></code></a></p>
<p>A base class for agents that route messages to handlers based on the type of the message
and optional matching functions.</p>
<p>To create a routed agent, subclass this class and add message handlers as methods decorated with
either <a class="reference internal" href="#agentopera.engine.agent.event" title="agentopera.engine.agent.event"><code class="xref py py-func docutils literal notranslate"><span class="pre">event()</span></code></a> or <a class="reference internal" href="#agentopera.engine.agent.rpc" title="agentopera.engine.agent.rpc"><code class="xref py py-func docutils literal notranslate"><span class="pre">rpc()</span></code></a> decorator.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">MessageContext</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoutedAgent</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">rpc</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Message</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MessageWithContent</span><span class="p">:</span>
    <span class="n">content</span><span class="p">:</span> <span class="nb">str</span>


<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Response</span><span class="p">:</span>
    <span class="k">pass</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MyAgent</span><span class="p">(</span><span class="n">RoutedAgent</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">&quot;MyAgent&quot;</span><span class="p">)</span>

    <span class="nd">@event</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handle_event_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">ctx</span><span class="o">.</span><span class="n">message_channel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">publish_message</span><span class="p">(</span><span class="n">MessageWithContent</span><span class="p">(</span><span class="s2">&quot;event handled&quot;</span><span class="p">),</span> <span class="n">ctx</span><span class="o">.</span><span class="n">message_channel</span><span class="p">)</span>

    <span class="nd">@rpc</span><span class="p">(</span><span class="n">match</span><span class="o">=</span><span class="k">lambda</span> <span class="n">message</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">message</span><span class="o">.</span><span class="n">content</span> <span class="o">==</span> <span class="s2">&quot;special&quot;</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">handle_special_rpc_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">MessageWithContent</span><span class="p">,</span> <span class="n">ctx</span><span class="p">:</span> <span class="n">MessageContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Response</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.RoutedAgent.cancel_token">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cancel_token</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.CancellationToken" title="agentopera.engine.types.agent.cancellation_token.CancellationToken"><span class="pre">CancellationToken</span></a></em><a class="headerlink" href="#agentopera.engine.agent.RoutedAgent.cancel_token" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.RoutedAgent.trigger_transient_cancel">
<span class="sig-name descname"><span class="pre">trigger_transient_cancel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#RoutedAgent.trigger_transient_cancel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.RoutedAgent.trigger_transient_cancel" title="Link to this definition"></a></dt>
<dd><p>Triggers the cancel, then resets the token after <cite>delay</cite> seconds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.RoutedAgent.on_message_impl">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_message_impl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#RoutedAgent.on_message_impl"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.RoutedAgent.on_message_impl" title="Link to this definition"></a></dt>
<dd><p>Handle a message by routing it to the appropriate message handler.
Do not override this method in subclasses. Instead, add message handlers as methods decorated with
either the <a class="reference internal" href="#agentopera.engine.agent.event" title="agentopera.engine.agent.event"><code class="xref py py-func docutils literal notranslate"><span class="pre">event()</span></code></a> or <a class="reference internal" href="#agentopera.engine.agent.rpc" title="agentopera.engine.agent.rpc"><code class="xref py py-func docutils literal notranslate"><span class="pre">rpc()</span></code></a> decorator.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.RoutedAgent.on_unhandled_message">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">on_unhandled_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#RoutedAgent.on_unhandled_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.RoutedAgent.on_unhandled_message" title="Link to this definition"></a></dt>
<dd><p>Called when a message is received that does not have a matching message handler.
The default implementation logs an info message.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="agentopera.engine.agent.event">
<span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Coroutine</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Coroutine</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MessageHandler</span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">MessageHandler</span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.event" title="Link to this definition"></a></dt>
<dd><p>Decorator for event message handlers.</p>
<p>Add this decorator to methods in a <a class="reference internal" href="#agentopera.engine.agent.RoutedAgent" title="agentopera.engine.agent.RoutedAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutedAgent</span></code></a> class that are intended to handle event messages.
These methods must have a specific signature that needs to be followed for it to be valid:</p>
<ul class="simple">
<li><p>The method must be an <cite>async</cite> method.</p></li>
<li><p>The method must be decorated with the <cite>&#64;message_handler</cite> decorator.</p></li>
<li><dl class="simple">
<dt>The method must have exactly 3 arguments:</dt><dd><ol class="arabic simple">
<li><p><cite>self</cite></p></li>
<li><p><cite>message</cite>: The event message to be handled, this must be type-hinted with the message type that it is intended to handle.</p></li>
<li><p><cite>ctx</cite>: A <code class="xref py py-class docutils literal notranslate"><span class="pre">agentopera.core.MessageContext</span></code> object.</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>The method must return <cite>None</cite>.</p></li>
</ul>
<p>Handlers can handle more than one message type by accepting a Union of the message types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be decorated.</p></li>
<li><p><strong>strict</strong> – If <cite>True</cite>, the handler will raise an exception if the message type is not in the target types. If <cite>False</cite>, it will log a warning instead.</p></li>
<li><p><strong>match</strong> – A function that takes the message and the context as arguments and returns a boolean. This is used for secondary routing after the message type. For handlers addressing the same message type, the match function is applied in alphabetical order of the handlers and the first matching handler will be called while the rest are skipped. If <cite>None</cite>, the first handler in alphabetical order matching the same message type will be called.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="agentopera.engine.agent.message_handler">
<span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">message_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Coroutine</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Coroutine</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MessageHandler</span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">MessageHandler</span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#message_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.message_handler" title="Link to this definition"></a></dt>
<dd><p>Decorator for generic message handlers.</p>
<p>Add this decorator to methods in a <a class="reference internal" href="#agentopera.engine.agent.RoutedAgent" title="agentopera.engine.agent.RoutedAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutedAgent</span></code></a> class that are intended to handle both event and RPC messages.
These methods must have a specific signature that needs to be followed for it to be valid:</p>
<ul class="simple">
<li><p>The method must be an <cite>async</cite> method.</p></li>
<li><p>The method must be decorated with the <cite>&#64;message_handler</cite> decorator.</p></li>
<li><dl class="simple">
<dt>The method must have exactly 3 arguments:</dt><dd><ol class="arabic simple">
<li><p><cite>self</cite></p></li>
<li><p><cite>message</cite>: The message to be handled, this must be type-hinted with the message type that it is intended to handle.</p></li>
<li><p><cite>ctx</cite>: A <code class="xref py py-class docutils literal notranslate"><span class="pre">agentopera.core.MessageContext</span></code> object.</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>The method must be type hinted with what message types it can return as a response, or it can return <cite>None</cite> if it does not return anything.</p></li>
</ul>
<p>Handlers can handle more than one message type by accepting a Union of the message types. It can also return more than one message type by returning a Union of the message types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be decorated.</p></li>
<li><p><strong>strict</strong> – If <cite>True</cite>, the handler will raise an exception if the message type or return type is not in the target types. If <cite>False</cite>, it will log a warning instead.</p></li>
<li><p><strong>match</strong> – A function that takes the message and the context as arguments and returns a boolean. This is used for secondary routing after the message type. For handlers addressing the same message type, the match function is applied in alphabetical order of the handlers and the first matching handler will be called while the rest are skipped. If <cite>None</cite>, the first handler in alphabetical order matching the same message type will be called.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="agentopera.engine.agent.rpc">
<span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">rpc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Coroutine</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Coroutine</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">MessageHandler</span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">MessageHandler</span><span class="p"><span class="pre">[</span></span><span class="pre">AgentT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ReceivesT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ProducesT</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/routed_agent.html#rpc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.rpc" title="Link to this definition"></a></dt>
<dd><p>Decorator for RPC message handlers.</p>
<p>Add this decorator to methods in a <a class="reference internal" href="#agentopera.engine.agent.RoutedAgent" title="agentopera.engine.agent.RoutedAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutedAgent</span></code></a> class that are intended to handle RPC messages.
These methods must have a specific signature that needs to be followed for it to be valid:</p>
<ul class="simple">
<li><p>The method must be an <cite>async</cite> method.</p></li>
<li><p>The method must be decorated with the <cite>&#64;message_handler</cite> decorator.</p></li>
<li><dl class="simple">
<dt>The method must have exactly 3 arguments:</dt><dd><ol class="arabic simple">
<li><p><cite>self</cite></p></li>
<li><p><cite>message</cite>: The message to be handled, this must be type-hinted with the message type that it is intended to handle.</p></li>
<li><p><cite>ctx</cite>: A <code class="xref py py-class docutils literal notranslate"><span class="pre">agentopera.core.MessageContext</span></code> object.</p></li>
</ol>
</dd>
</dl>
</li>
<li><p>The method must be type hinted with what message types it can return as a response, or it can return <cite>None</cite> if it does not return anything.</p></li>
</ul>
<p>Handlers can handle more than one message type by accepting a Union of the message types. It can also return more than one message type by returning a Union of the message types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be decorated.</p></li>
<li><p><strong>strict</strong> – If <cite>True</cite>, the handler will raise an exception if the message type or return type is not in the target types. If <cite>False</cite>, it will log a warning instead.</p></li>
<li><p><strong>match</strong> – A function that takes the message and the context as arguments and returns a boolean. This is used for secondary routing after the message type. For handlers addressing the same message type, the match function is applied in alphabetical order of the handlers and the first matching handler will be called while the rest are skipped. If <cite>None</cite>, the first handler in alphabetical order matching the same message type will be called.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="agentopera.engine.agent.ToolAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">agentopera.engine.agent.</span></span><span class="sig-name descname"><span class="pre">ToolAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tools</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="engine.function_call.html#agentopera.engine.function_call.Tool" title="agentopera.engine.function_call.base.Tool"><span class="pre">Tool</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/agentopera/engine/agent/tool_agent.html#ToolAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ToolAgent" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#agentopera.engine.agent.RoutedAgent" title="agentopera.engine.agent.routed_agent.RoutedAgent"><code class="xref py py-class docutils literal notranslate"><span class="pre">RoutedAgent</span></code></a></p>
<p>A tool agent accepts direct messages of the type <cite>FunctionCall</cite>,
executes the requested tool with the provided arguments, and returns the
result as <cite>FunctionExecutionResult</cite> messages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>description</strong> (<em>str</em>) – The description of the agent.</p></li>
<li><p><strong>tools</strong> (<em>List</em><em>[</em><a class="reference internal" href="engine.function_call.html#agentopera.engine.function_call.Tool" title="agentopera.engine.function_call.Tool"><em>Tool</em></a><em>]</em>) – The list of tools that the agent can execute.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="agentopera.engine.agent.ToolAgent.tools">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tools</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="engine.function_call.html#agentopera.engine.function_call.Tool" title="agentopera.engine.function_call.base.Tool"><span class="pre">Tool</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#agentopera.engine.agent.ToolAgent.tools" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="agentopera.engine.agent.ToolAgent.handle_function_call">
<em class="property"><span class="pre">async</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">handle_function_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.function_call.html#agentopera.engine.function_call.FunctionCall" title="agentopera.engine.function_call.function_call.FunctionCall"><span class="pre">FunctionCall</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="engine.types.html#agentopera.engine.types.msg_context.MessageContext" title="agentopera.engine.types.msg_context.message_context.MessageContext"><span class="pre">MessageContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="engine.types.html#agentopera.engine.types.models.FunctionExecutionResult" title="agentopera.engine.types.models.types.FunctionExecutionResult"><span class="pre">FunctionExecutionResult</span></a></span></span><a class="reference internal" href="../_modules/agentopera/engine/agent/tool_agent.html#ToolAgent.handle_function_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#agentopera.engine.agent.ToolAgent.handle_function_call" title="Link to this definition"></a></dt>
<dd><p>Handles a <cite>FunctionCall</cite> message by executing the requested tool with the provided arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> (<a class="reference internal" href="engine.function_call.html#agentopera.engine.function_call.FunctionCall" title="agentopera.engine.function_call.FunctionCall"><em>FunctionCall</em></a>) – The function call message.</p></li>
<li><p><strong>cancellation_token</strong> (<a class="reference internal" href="engine.types.html#agentopera.engine.types.agent.CancellationToken" title="agentopera.engine.types.agent.CancellationToken"><em>CancellationToken</em></a>) – The cancellation token.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the function execution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="engine.types.html#agentopera.engine.types.models.FunctionExecutionResult" title="agentopera.engine.types.models.FunctionExecutionResult">FunctionExecutionResult</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ToolNotFoundException</strong> – If the tool is not found.</p></li>
<li><p><strong>InvalidToolArgumentsException</strong> – If the tool arguments are invalid.</p></li>
<li><p><strong>ToolExecutionException</strong> – If the tool execution fails.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="engine.html" class="btn btn-neutral float-left" title="engine" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="engine.function_call.html" class="btn btn-neutral float-right" title="engine.function_call" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, tensoropera.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>