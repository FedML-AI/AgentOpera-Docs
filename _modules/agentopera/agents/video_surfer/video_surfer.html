

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>agentopera.agents.video_surfer.video_surfer &mdash; AgentOpera API References 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../../_static/doctools.js?v=888ff710"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            AgentOpera API References
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Chatflow Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.html">chatflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.agents.html">chatflow.agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.base.html">chatflow.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.conditions.html">chatflow.conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.media.html">chatflow.media</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.state.html">chatflow.state</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.team.html">chatflow.team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.ui.html">chatflow.ui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../chatflow/chatflow.utils.html">chatflow.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Engine Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.html">engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.agent.html">engine.agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.function_call.html">engine.function_call</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.protocol.html">engine.protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.runtime.html">engine.runtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.telemetry.html">engine.telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../engine/engine.types.html">engine.types</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Agents Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.html">agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.openai.html">agents.openai</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.magentic_one.html">agents.magentic_one</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.magentic_one_team.html">agents.magentic_one_team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.web_surfer.html">agents.web_surfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.video_surfer.html">agents.video_surfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.file_surfer.html">agents.file_surfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../agents/agents.code_executor.html">agents.code_executor</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Router Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../router/router.html">router</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../router/router.workers.html">router.workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../router/router.user.html">router.user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../router/router.session.html">router.session</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.html">models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.openai.html">models.openai</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.anthropic.html">models.anthropic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.azure.html">models.azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.ollama.html">models.ollama</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.replay.html">models.replay</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.cache.html">models.cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../models/models.utils.html">models.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Memory Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/memory.html">memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../memory/memory.graphrag.html">memory.graphrag</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tools/tools.html">tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tools/tools.http.html">tools.http</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tools/tools.code_execution.html">tools.code_execution</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">UI Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../ui/ui.html">ui</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utils Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/utils.html">utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Adapter Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../adapter/adapter.html">adapter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../adapter/adapter.langchain.html">adapter.langchain</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">MCP Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../mcp/mcp.html">mcp</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Zerocode Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../zerocode/zerocode.html">zerocode</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Edge Module</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../edge/edge.html">edge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">AgentOpera API References</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">agentopera.agents.video_surfer.video_surfer</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for agentopera.agents.video_surfer.video_surfer</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Awaitable</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.chatflow.agents</span><span class="w"> </span><span class="kn">import</span> <span class="n">AssistantAgent</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.engine.types.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChatCompletionClient</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">agentopera.engine.function_call</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseTool</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.tools</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">extract_audio</span><span class="p">,</span>
    <span class="n">get_screenshot_at</span><span class="p">,</span>
    <span class="n">get_video_length</span><span class="p">,</span>
    <span class="n">save_screenshot</span><span class="p">,</span>
    <span class="n">transcribe_audio_with_timestamps</span><span class="p">,</span>
    <span class="n">transcribe_video_screenshot</span><span class="p">,</span>
<span class="p">)</span>


<div class="viewcode-block" id="VideoSurfer">
<a class="viewcode-back" href="../../../../agents/agents.video_surfer.html#agentopera.agents.video_surfer.VideoSurfer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">VideoSurfer</span><span class="p">(</span><span class="n">AssistantAgent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    VideoSurfer is a specialized agent designed to answer questions about a local video file.</span>

<span class="sd">    Installation:</span>

<span class="sd">    .. code-block:: bash</span>

<span class="sd">        pip install &quot;agentopera[video-surfer]&quot;</span>

<span class="sd">    This agent utilizes various tools to extract information from the video, such as its length, screenshots at specific timestamps, and audio transcriptions. It processes these elements to provide detailed answers to user queries.</span>

<span class="sd">    Available tools:</span>

<span class="sd">    - :func:`~agentopera.agents.agents.video_surfer.tools.extract_audio`</span>
<span class="sd">    - :func:`~agentopera.agents.agents.video_surfer.tools.get_video_length`</span>
<span class="sd">    - :func:`~agentopera.agents.agents.video_surfer.tools.transcribe_audio_with_timestamps`</span>
<span class="sd">    - :func:`~agentopera.agents.agents.video_surfer.tools.get_screenshot_at`</span>
<span class="sd">    - :func:`~agentopera.agents.agents.video_surfer.tools.save_screenshot`</span>
<span class="sd">    - :func:`~agentopera.agents.agents.video_surfer.tools.transcribe_video_screenshot`</span>

<span class="sd">    Args:</span>
<span class="sd">        name (str): The name of the agent.</span>
<span class="sd">        model_client (ChatCompletionClient): The model client used for generating responses.</span>
<span class="sd">        tools (List[BaseTool[BaseModel, BaseModel]  | Callable[..., Any] | Callable[..., Awaitable[Any]]] | None, optional):</span>
<span class="sd">            A list of tools or functions the agent can use. If not provided, defaults to all video tools from the action space.</span>
<span class="sd">        description (str, optional): A brief description of the agent. Defaults to &quot;An agent that can answer questions about a local video.&quot;.</span>
<span class="sd">        system_message (str | None, optional): The system message guiding the agent&#39;s behavior. Defaults to a predefined message.</span>

<span class="sd">    Example usage:</span>

<span class="sd">    The following example demonstrates how to create an video surfing agent with</span>
<span class="sd">    a model client and generate a response to a simple query about a local video</span>
<span class="sd">    called video.mp4.</span>

<span class="sd">        .. code-block:: python</span>


<span class="sd">            import asyncio</span>
<span class="sd">            from agentopera.chatflow.ui import Console</span>
<span class="sd">            from agentopera.chatflow.conditions import TextMentionTermination</span>
<span class="sd">            from agentopera.chatflow.teams import RoundRobinGroupChat</span>
<span class="sd">            from agentopera.models.openai import OpenAIChatCompletionClient</span>
<span class="sd">            from agentopera.agents.agents.video_surfer import VideoSurfer</span>

<span class="sd">            async def main() -&gt; None:</span>
<span class="sd">                \&quot;\&quot;\&quot;</span>
<span class="sd">                Main function to run the video agent.</span>
<span class="sd">                \&quot;\&quot;\&quot;</span>
<span class="sd">                # Define an agent</span>
<span class="sd">                video_agent = VideoSurfer(</span>
<span class="sd">                    name=&quot;VideoSurfer&quot;,</span>
<span class="sd">                    model_client=OpenAIChatCompletionClient(model=&quot;gpt-4o-2024-08-06&quot;)</span>
<span class="sd">                    )</span>

<span class="sd">                # Define termination condition</span>
<span class="sd">                termination = TextMentionTermination(&quot;TERMINATE&quot;)</span>

<span class="sd">                # Define a team</span>
<span class="sd">                agent_team = RoundRobinGroupChat([video_agent], termination_condition=termination)</span>

<span class="sd">                # Run the team and stream messages to the console</span>
<span class="sd">                stream = agent_team.run_stream(task=&quot;How does Adam define complex tasks in video.mp4? What concrete example of complex does his use? Can you save this example to disk as well?&quot;)</span>
<span class="sd">                await Console(stream)</span>

<span class="sd">            asyncio.run(main())</span>

<span class="sd">    The following example demonstrates how to create and use a VideoSurfer and UserProxyAgent with MagenticOneGroupChat.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            import asyncio</span>

<span class="sd">            from agentopera.chatflow.ui import Console</span>
<span class="sd">            from agentopera.chatflow.teams import MagenticOneGroupChat</span>
<span class="sd">            from agentopera.chatflow.agents import UserProxyAgent</span>
<span class="sd">            from agentopera.models.openai import OpenAIChatCompletionClient</span>
<span class="sd">            from agentopera.agents.agents.video_surfer import VideoSurfer</span>

<span class="sd">            async def main() -&gt; None:</span>
<span class="sd">                \&quot;\&quot;\&quot;</span>
<span class="sd">                Main function to run the video agent.</span>
<span class="sd">                \&quot;\&quot;\&quot;</span>

<span class="sd">                model_client = OpenAIChatCompletionClient(model=&quot;gpt-4o-2024-08-06&quot;)</span>

<span class="sd">                # Define an agent</span>
<span class="sd">                video_agent = VideoSurfer(</span>
<span class="sd">                    name=&quot;VideoSurfer&quot;,</span>
<span class="sd">                    model_client=model_client</span>
<span class="sd">                    )</span>

<span class="sd">                web_surfer_agent = UserProxyAgent(</span>
<span class="sd">                    name=&quot;User&quot;</span>
<span class="sd">                )</span>

<span class="sd">                # Define a team</span>
<span class="sd">                agent_team = MagenticOneGroupChat([web_surfer_agent, video_agent], model_client=model_client,)</span>

<span class="sd">                # Run the team and stream messages to the console</span>
<span class="sd">                stream = agent_team.run_stream(task=&quot;Find a latest video about magentic one on youtube and extract quotes from it that make sense.&quot;)</span>
<span class="sd">                await Console(stream)</span>

<span class="sd">            asyncio.run(main())</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">DEFAULT_DESCRIPTION</span> <span class="o">=</span> <span class="s2">&quot;An agent that can answer questions about a local video.&quot;</span>

    <span class="n">DEFAULT_SYSTEM_MESSAGE</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    You are a helpful agent that is an expert at answering questions from a video.</span>
<span class="s2">    When asked to answer a question about a video, you should:</span>
<span class="s2">    1. Check if that video is available locally.</span>
<span class="s2">    2. Use the transcription to find which part of the video the question is referring to.</span>
<span class="s2">    3. Optionally use screenshots from those timestamps</span>
<span class="s2">    4. Provide a detailed answer to the question.</span>
<span class="s2">    Reply with TERMINATE when the task has been completed.</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">model_client</span><span class="p">:</span> <span class="n">ChatCompletionClient</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">tools</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseTool</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Awaitable</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">description</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">system_message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">model_client</span><span class="o">=</span><span class="n">model_client</span><span class="p">,</span>
            <span class="n">tools</span><span class="o">=</span><span class="n">tools</span>
            <span class="ow">or</span> <span class="p">[</span>
                <span class="n">get_video_length</span><span class="p">,</span>
                <span class="n">get_screenshot_at</span><span class="p">,</span>
                <span class="n">save_screenshot</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vs_transribe_video_screenshot</span><span class="p">,</span>
                <span class="n">extract_audio</span><span class="p">,</span>
                <span class="n">transcribe_audio_with_timestamps</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_DESCRIPTION</span><span class="p">,</span>
            <span class="n">system_message</span><span class="o">=</span><span class="n">system_message</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEFAULT_SYSTEM_MESSAGE</span><span class="p">,</span>
        <span class="p">)</span>

<div class="viewcode-block" id="VideoSurfer.vs_transribe_video_screenshot">
<a class="viewcode-back" href="../../../../agents/agents.video_surfer.html#agentopera.agents.video_surfer.VideoSurfer.vs_transribe_video_screenshot">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">vs_transribe_video_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transcribes the video screenshot at a specific timestamp.</span>

<span class="sd">        Args:</span>
<span class="sd">            video_path (str): Path to the video file.</span>
<span class="sd">            timestamp (float): Timestamp to take the screenshot.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: Transcription of the video screenshot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="k">await</span> <span class="n">transcribe_video_screenshot</span><span class="p">(</span><span class="n">video_path</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_client</span><span class="p">)</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, tensoropera.ai.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>